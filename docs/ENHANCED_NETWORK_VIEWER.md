# Покращений інтерактивний візуалізатор мережі

## Огляд

Покращений інтерактивний візуалізатор мережі (`EnhancedInteractiveNetworkViewer`) - це розширена версія базового інтерактивного візуалізатора з додатковими можливостями динамічної візуалізації та автоматичної синхронізації з базою даних.

## Нові можливості

### 1. Форми вузлів залежно від кількості зв'язків (degree)

Вузли автоматично змінюють свою форму в залежності від кількості зв'язків:

- **Коло** (d≤2) - простий вузол з 1-2 зв'язками
- **Трикутник** (d=3) - вузол з 3 зв'язками
- **Квадрат** (d=4) - вузол з 4 зв'язками
- **П'ятикутник** (d=5) - вузол з 5 зв'язками
- **Шестикутник** (d≥6) - вузол з 6+ зв'язками

### 2. Покращена інтерактивність

- **Підсвічування при наведенні** - вузли та зв'язки підсвічуються при наведенні миші
- **Перетягування вузлів** - можливість переміщення вузлів мишею
- **Виділення пов'язаних вузлів** - при кліку на вузол виділяються всі пов'язані вузли для аналізу хрупкості
- **Масштабування** - можливість збільшення/зменшення масштабу колесиком миші

### 3. Автоматична синхронізація з базою даних

- **Збереження в .db файли** - автоматичне збереження змін у файли бази даних
- **Функція `render_network_from_db()`** - завантаження мережі з бази даних
- **Словникове сховище Python** - використання `shelve` для збереження даних
- **Автоматичне оновлення** - зміни автоматично зберігаються при редагуванні

### 4. Плавні анімації

- **Анімоване оновлення** - плавні переходи при зміні структури мережі
- **Ефекти виділення** - візуальні ефекти при взаємодії з елементами
- **Динамічне оновлення** - автоматичне перерахунок форм вузлів при змінах

## Технічні деталі

### Архітектура

```python
class EnhancedInteractiveNetworkViewer:
    """Покращений інтерактивний візуалізатор топології мережі"""
    
    def __init__(self, parent, topology_frame=None):
        # Ініціалізація з підтримкою всіх нових можливостей
        
    def _get_node_shape(self, degree):
        """Повертає форму вузла в залежності від ступеня"""
        
    def render_network_from_db(self, filename):
        """Завантажує мережу з .db та будує візуалізацію"""
        
    def _save_network_to_db(self, filename):
        """Зберігає мережу в базу даних"""
```

### Формати даних

#### Структура мережі в пам'яті:
```python
{
    'nodes': [
        {
            'id': 'node_1',
            'x': 2.0, 'y': 8.0,
            'type': 'server',
            'capacity': 1000,
            'reliability': 0.95,
            'degree': 3  # Кількість зв'язків
        }
    ],
    'connections': {
        'node_1': ['node_2', 'node_3'],
        'node_2': ['node_1']
    },
    'edge_properties': {
        'node_1-node_2': {
            'bandwidth': 100,
            'latency': 5.0,
            'reliability': 0.98
        }
    }
}
```

#### Формат збереження в .db:
```python
# Використовується shelve для словникового збереження
{
    'network_data': { ... },  # Дані мережі
    'timestamp': 1234567890    # Час збереження
}
```

## Використання

### Інтеграція з основним додатком

Покращений візуалізатор автоматично інтегрується в головне вікно:

```python
# В main_window.py
try:
    from .enhanced_interactive_network_viewer import EnhancedInteractiveNetworkViewer
    self.network_viewer = EnhancedInteractiveNetworkViewer(self, self.topology_frame)
except ImportError:
    # Fallback на базовий візуалізатор
    from .interactive_network_viewer import InteractiveNetworkViewer
    self.network_viewer = InteractiveNetworkViewer(self, self.topology_frame)
```

### Програмне використання

```python
from src.gui.enhanced_interactive_network_viewer import EnhancedInteractiveNetworkViewer

# Створення візуалізатора
viewer = EnhancedInteractiveNetworkViewer(parent_window)

# Завантаження з бази даних
viewer.render_network_from_db("my_network.db")

# Збереження в базу даних
viewer._save_network_to_db("my_network.db")

# Отримання даних мережі
network_data = viewer.get_network_data()
```

## Режими редагування

### 1. Перегляд
- Виділення вузлів та зв'язків
- Перетягування вузлів
- Масштабування колесиком миші

### 2. Додати вузол
- Клік по холсту для додавання вузла
- Автоматичне оновлення форм при зміні зв'язків

### 3. Додати зв'язок
- Клік по двох вузлах для створення зв'язку
- Автоматичне оновлення ступенів вузлів

### 4. Видалити
- Клік по елементу для видалення
- Автоматичне оновлення структури

## Аналіз та експорт

### Аналіз зв'язності
- Перевірка зв'язності мережі
- Обчислення діаметра та середньої довжини шляху
- Визначення компонент зв'язності

### Експорт для аналізу надійності
- Перетворення даних у формат для аналізу надійності
- Інтеграція з модулем аналізу надійності
- Підтримка всіх функцій базового візуалізатора

## Налаштування

### Автоматичне збереження
```python
# Увімкнення/вимкнення автоматичного збереження
viewer.auto_save_enabled = True
viewer.db_filename = "my_network.db"
```

### Анімації
```python
# Увімкнення/вимкнення анімацій
viewer.animation_enabled = True
```

## Сумісність

Покращений візуалізатор повністю сумісний з базовим інтерактивним візуалізатором:

- Всі методи базового візуалізатора збережені
- Підтримка всіх існуючих функцій
- Зворотна сумісність з існуючим кодом

## Тестування

### Запуск тестів
```bash
python scripts/tests/test_enhanced_network_viewer.py
```

### Демонстрація
```bash
python scripts/demos/demo_enhanced_network_viewer.py
```

## Переваги

1. **Візуальна інформативність** - форми вузлів показують їх важливість у мережі
2. **Покращена інтерактивність** - зручніше редагування та аналіз
3. **Автоматичне збереження** - не втрачаються зміни
4. **Плавні анімації** - приємніший користувацький досвід
5. **Масштабування** - можливість детального аналізу великих мереж
6. **Аналіз хрупкості** - швидке визначення критичних вузлів

## Обмеження

1. **Шрифти** - деякі Unicode символи можуть не відображатися
2. **Продуктивність** - анімації можуть сповільнювати роботу на великих мережах
3. **База даних** - використовується простий формат shelve (не підходить для великих обсягів)

## Майбутні покращення

1. **Підтримка великих мереж** - оптимізація для мереж з тисячами вузлів
2. **Розширені анімації** - більше візуальних ефектів
3. **Експорт у різні формати** - PNG, SVG, PDF
4. **Інтеграція з зовнішніми БД** - PostgreSQL, MySQL
5. **3D візуалізація** - тривимірне відображення мережі
